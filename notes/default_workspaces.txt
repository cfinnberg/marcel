
exists: true for default, otherwise, see if marker exists

Workspace
    - name
    create_time()
    open_time()
    save_time()
    is_default()
    exists()
    create()
    open()
    close()
    set_home()

WorkspaceNamed
    - properties
    - persistent_state
    create_time()
    open_time()
    save_time()
    is_default()
    is_open()
    create()
    open()
    close()
    set_home()

    delete()
    home()

WorkspaceDefault

close()

- Sets self.env_file to temp file, writes env there. 

*** But this deletes reservoirs! Need to rethink ws lifecycle across ReconfigureException.

open()

- Reads and discards temp file

----------------------------------------------------------------------

Workspace.close: 

- Close and delete reservoirs.

- This is correct for default workspace on shutdown, but not on restart.

WorkspaceNamed.close:

- Close reservoirs, don't delete them.

WorkspaceDefault.close:

- Close reservoirs. On shutdown, delete them. On restart, keep them.

----------------------------------------------------------------------

To do:

- lifecycle testing: Check across process and ws boundaries:

    - reservoirs

    - imports

    - assigned vars


Dtructure on disk:

    CURRENT:

    .config/marcel/
        startup.py  # For anon workspaces, and template for named
        .WORKSPACE  # Marker for default workspace
        WORKSPACE_NAME/
            .WORKSPACE  # Empty file marking this directory as a workspace
            startup.py

    .local/share/marcel/
        history
        reservoirs/  # FOR DEFAULT WORKSPACE 
            <pid>.<varname>.pickle  # Deleted at end of session
        WORKSPACE_NAME/
            properties.pickle
            env.pickle
            history
            reservoirs/
                <varname>.pickle

    NEW:

    .config/marcel/
        __DEFAULT_WORKSPACE__
            startup.py
            .WORKSPACE
        WORKSPACE_NAME/
            .WORKSPACE  # Empty file marking this directory as a workspace
            startup.py

    .local/share/marcel/
        __DEFAULT_WORKSPACE__
            history
            reservoirs/
                <pid>.<varname>.pickle  # Deleted at end of session
        WORKSPACE_NAME/
            properties.pickle
            env.pickle
            history
            reservoirs/
                <varname>.pickle

 
  - Similar for .local/share/marcel
  



Test for valid new workspace name. What happens if creating the dir
fails due to a bad filename?

----------------------------------------------------------------------

Test setup of Main and Environment:

test_ops: TEST = test_base.TestConsole()
    TestConsole.__init__(config_file='./.marcel.py')
        TestBase.__init__(config_file)
            TestConsole.reset_environment
                TestBase.reset_environment
                    set HOME to /tmp/test_home
                    EXPLICIT SETUP OF WORKSPACE DIRS
                Copy config file to default workspace startup.py
                EnvironmentInteractive.create WHICH SHOULD SETUP WORKSPACE THE RIGHT WAY

